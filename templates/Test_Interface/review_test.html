{% extends 'Test_Interface/base.html' %}

{% block title %}Review Test | MGM JNEC PYQ Portal{% endblock %}

{% block content %}
<div class="content-box">
    <h2 style="color: var(--text-primary); margin-bottom: 20px; font-weight: 600;">
        <i class="bi bi-eye-fill me-2"></i> Review: {{ test.name }}
    </h2>
    
    {% for qa in questions_with_attempts %}
    <div class="question-card" style="margin-bottom: 30px;">
        <div class="question-text">
            <strong>Question {{ forloop.counter }}:</strong> {{ qa.question.text }}
        </div>
        
        <div class="options-list" style="margin-top: 15px;">
            {% for idx in "1234" %}
                <div class="option-label 
                    {% if qa.attempt and qa.attempt.selected_option|stringformat:'s' == idx %}selected-{% if qa.is_correct %}correct{% else %}wrong{% endif %}{% endif %} 
                    {% if qa.question.correct_option|stringformat:'s' == idx %}correct-answer{% endif %}">
                    {{ qa.question|get_option:idx }}
                </div>
            {% endfor %}
        </div>
        
        <div class="feedback-box {% if qa.is_correct %}correct{% else %}wrong{% endif %}" style="margin-top: 15px;">
            <i class="bi bi-{% if qa.is_correct %}check{% else %}x{% endif %}-circle-fill"></i>
            {% if qa.is_correct %}You answered correctly!{% else %}Your answer was incorrect.{% endif %}
        </div>
        
        <div class="solution-box" style="margin-top: 15px;">
            <strong>Solution:</strong> {{ qa.question.solution }}
        </div>
    </div>
    {% endfor %}
    
    <div class="action-buttons" style="text-align: center; margin-top: 30px;">
        <a href="{% url 'display_test_result' test.id %}" class="btn-custom-primary">
            <i class="bi bi-arrow-left-circle-fill me-2"></i> Back to Results
        </a>
        <a href="{% url 'dashboard' %}" class="btn-custom-outline">
            <i class="bi bi-house-door-fill me-2"></i> Dashboard
        </a>
    </div>
</div>
{% endblock %}